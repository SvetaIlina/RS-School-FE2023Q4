(()=>{"use strict";var e={692:(e,t,s)=>{s.r(t)},421:(e,t,s)=>{s.r(t)},189:(e,t,s)=>{s.r(t)},446:(e,t,s)=>{s.r(t)},80:(e,t,s)=>{s.r(t)},455:(e,t,s)=>{s.r(t)},747:(e,t,s)=>{s.r(t)},306:(e,t,s)=>{s.r(t)},483:(e,t,s)=>{s.r(t)},823:(e,t,s)=>{s.r(t)},738:(e,t,s)=>{s.r(t)},827:(e,t,s)=>{s.r(t)},315:(e,t,s)=>{s.r(t)},343:(e,t,s)=>{s.r(t)},581:(e,t,s)=>{s.r(t)},284:(e,t,s)=>{s.r(t)},181:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class s{constructor(e,t){this.element=document.createElement(e.tag),this.setElement(e),t&&this.addChild(t)}getElement(){return this.element}setElement(e){this.setStyles(e.classes),e.textContent&&this.setTextContent(e.textContent),e.attributes&&this.setAttributes(e.attributes)}addChild(e){e.forEach((e=>{e instanceof s?this.element.append(e.getElement()):this.element.append(e)}))}removeChild(){for(;this.element.firstChild;)this.element.firstChild.remove()}setStyles(e){e.forEach((e=>{e&&this.element.classList.add(e)}))}setAttributes(e){e.forEach((e=>{this.element.setAttribute(e.key,e.value)}))}setTextContent(e){this.element.textContent=e}setCallback(e,t){"function"==typeof e&&this.element.addEventListener(t,e)}}t.default=s},203:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(181));s(692);class n extends i.default{constructor(e,t,s,a){super({tag:"button",classes:e,textContent:t}),this.setCallback(s,"click"),this.setStyles(["btn"]),a&&this.setAttributes([{key:"type",value:`${a}`}])}}t.default=n},880:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(181)),n=a(s(276)),o=a(s(173));s(421);class l extends i.default{constructor(e,t){super({tag:"div",classes:["chat"]}),this.dialog=new o.default,this.contact=new n.default(e,t),this.addChild([this.contact,this.dialog])}updateContact(e){this.contact.updateContact(e)}setHeader(e){this.dialog.updateHeader(e)}drawNewMessage(e){this.dialog.addMessage(e)}updateDialog(){this.dialog.updateDialogMessage()}}t.default=l},720:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const a=s(187);t.default=class{constructor(){this.storageKey="myUser",this.dialog=null,this.contacts=null,this.currentContact=null,this.myUser=null,this.ActiveUser=[],this.inActiveUser=[],this.isLogined=!1}setMyUser(){sessionStorage.setItem(this.storageKey,JSON.stringify(this.myUser)),this.isLogined=!0}checkSavedUser(){return!!sessionStorage.getItem(this.storageKey)&&(this.isLogined=!0,this.myUser=this.getUser(),!0)}checkLogginedUser(){(0,a.isNotNull)(this.myUser);const e=this.ActiveUser;return-1!==(0,a.findUserIndex)(e,this.myUser)}getUser(){const e=sessionStorage.getItem(this.storageKey);return(0,a.isNotNull)(e),JSON.parse(e)}deleteUser(){this.myUser=null,this.isLogined=!1,sessionStorage.removeItem(this.storageKey)}getAllContact(){const e=[...this.ActiveUser,...this.inActiveUser];(0,a.isNotNull)(this.myUser);const t=(0,a.findUserIndex)(e,this.myUser);return-1!==t&&e.splice(t,1),e}changeUserStatus(e){if(e.isLogined){this.ActiveUser.push(e);const t=(0,a.findUserIndex)(this.inActiveUser,e);-1!==t&&this.inActiveUser.splice(t,1)}else{this.inActiveUser.push(e);const t=(0,a.findUserIndex)(this.ActiveUser,e);this.ActiveUser.splice(t,1)}}setCurrentContact(e){const t=this.getAllContact().find((t=>t.login===e));t&&(this.currentContact=t)}checkMessage(e){(0,a.isNotNull)(this.myUser);let t,s=e.from,i=!1;const n=new Date(e.datetime).toLocaleString("en-US");return s===this.myUser.login&&(s="you",i=!0),t=e.status.isDelivered?"delivered":"undelivered",{text:e.text,sender:s,date:n,isYour:i,deliveredStatus:t}}}},276:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(187),n=a(s(181));s(189);class o extends n.default{constructor(e,t){super({tag:"div",classes:["contacts"]}),this.searchInput=new n.default({tag:"input",classes:["contacts_search"],attributes:[{key:"placeholder",value:"Search..."}]}),this.contactList=new n.default({tag:"ul",classes:["contacts_list"]}),this.listCallback=t,this.contact=e,this.init(this.contact),this.searchInput.setCallback((e=>(0,i.searchUser)(e,this.contactList.getElement())),"keyup"),this.contactList.setCallback((e=>{this.handleListEvent(e)}),"click")}init(e){this.drawContacts(e),this.addChild([this.searchInput,this.contactList])}handleListEvent(e){const t=(0,i.getSelectedContact)(e);t&&this.listCallback(t)}drawContacts(e){e.forEach((e=>{this.addNewContact(e)}))}addNewContact(e){const t=new n.default({tag:"li",classes:["list_item"],attributes:[{key:"id",value:`${e.login}`}]});e.isLogined&&t.setStyles(["active"]);const s=new n.default({tag:"span",classes:["list_item-name"],textContent:e.login}),a=new n.default({tag:"span",classes:["list_item-mes"],textContent:""});t.addChild([s,a]),this.contactList.addChild([t])}updateContact(e){const t=e.isLogined,s=document.getElementById(`${e.login}`);s?t?s.classList.add("active"):s.classList.remove("active"):this.addNewContact(e)}}t.default=o},75:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(505),n=a(s(181));s(446);class o extends n.default{constructor(){super({tag:"div",classes:["dialog_header"]}),this.userName=new n.default({tag:"span",classes:["dialog_header-name"]}),this.userStatus=new n.default({tag:"span",classes:["dialog_header-status"]}),this.addChild([this.userName,this.userStatus])}setUserValue(e){let t;this.userName.setTextContent(e.login),e.isLogined?(t=i.userStatus.OnLine,this.setStyles(["active"])):(t=i.userStatus.OffLine,this.getElement().classList.remove("active")),this.userStatus.setTextContent(t)}}t.default=o},173:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(181)),n=a(s(75));s(80);const o=a(s(926)),l=a(s(962));class r extends i.default{constructor(){super({tag:"div",classes:["dialog"]}),this.header=new n.default,this.messages=new l.default,this.messageInput=new o.default,this.addChild([this.header,this.messages,this.messageInput])}updateHeader(e){this.header.setUserValue(e)}addMessage(e){this.messages.element.querySelector(".description")&&this.messages.removeChild(),this.messages.addChild([e])}updateDialogMessage(){this.messages.init()}}t.default=r},926:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(187),n=a(s(181)),o=a(s(203));s(455);class l extends n.default{constructor(){super({tag:"div",classes:["dialog_input"]}),this.messageInput=new n.default({tag:"input",classes:["message_input"],attributes:[{key:"placeholder",value:"message..."}]}),this.sendBtn=new o.default(["send_btn","inactive"],"send",(e=>this.sendedMessage(e))),this.messageInput.setCallback((()=>this.enableBtn()),"keyup"),this.addChild([this.messageInput,this.sendBtn])}sendedMessage(e){const t=e.target;(0,i.isNotNullElement)(t);const s=this.messageInput.getElement(),a=s.value;if(a){const e=new CustomEvent("sendMes",{bubbles:!0,detail:a});t.dispatchEvent(e)}s.value="",t.classList.add("inactive")}enableBtn(){const e=this.messageInput.getElement(),t=this.sendBtn.getElement();e.value?t.classList.remove("inactive"):t.classList.add("inactive")}}t.default=l},962:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(181));s(747);class n extends i.default{constructor(){super({tag:"div",classes:["message-container"]}),this.init()}init(){this.removeChild();const e=new i.default({tag:"p",classes:["description"],textContent:"Select the user to send the message to..."});this.addChild([e])}}t.default=n},555:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(181));s(306);class n extends i.default{constructor(e){super({tag:"div",classes:["message-wrapper"]}),this.messageContent=e.text,this.messageDataTime=e.date,this.sender=e.sender,this.status=e.deliveredStatus,this.isMyMessage=e.isYour,this.drawMessage(this.sender,this.messageDataTime,this.messageContent,this.status)}drawMessage(e,t,s,a){const n=new i.default({tag:"div",classes:["message"]}),o=new i.default({tag:"div",classes:["message_header"]}),l=new i.default({tag:"span",classes:["message_header-item"],textContent:`${e}`}),r=new i.default({tag:"span",classes:["message_header-item"],textContent:`${t}`});o.addChild([l,r]);const d=new i.default({tag:"div",classes:["message_content"],textContent:`${s}`}),u=new i.default({tag:"div",classes:["message_footer"]});this.isMyMessage&&(this.setStyles(["myMessage"]),u.setTextContent(`${a}`)),n.addChild([o,d,u]),this.addChild([n])}}t.default=n},42:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(181));s(483);const n=a(s(72)),o=a(s(679));class l extends i.default{constructor(){super({tag:"footer",classes:["footer"]}),this.configView()}configView(){const e=new i.default({tag:"img",classes:["footer_img"],attributes:[{key:"src",value:`${n.default}`}]}),t=new i.default({tag:"span",classes:["footer_item"],textContent:"2024"}),s=new o.default;this.addChild([e,s,t])}}t.default=l},514:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(181)),n=a(s(203));s(823);class o extends i.default{constructor(e,t,s,a){super({tag:"header",classes:["header"]}),this.userName=e,this.appName=t,this.logOutBtn=new n.default(["header_btn"],"Log Out",s),this.infoBtn=new n.default(["header_btn"],"About",a),this.configView()}configView(){const e=new i.default({tag:"div",classes:["btnWrapper"]});e.addChild([this.infoBtn,this.logOutBtn]);const t=new i.default({tag:"span",classes:["header_item"],textContent:`User : ${this.userName}`}),s=new i.default({tag:"span",classes:["header_item"],textContent:`${this.appName}`});this.addChild([t,s,e])}}t.default=o},292:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(187),n=a(s(181));s(827);class o extends n.default{constructor(e,t,s,a,i,o){super({tag:"div",classes:["inputContainer"]}),this.input=new n.default({tag:"input",classes:["inputField"],attributes:[{key:"required",value:""},{key:"type",value:`${a}`},{key:"minlength",value:`${t}`},{key:"name",value:`${s}`}]}),this.input.setCallback((()=>this.setValidMessage(i,o)),"input"),this.label=new n.default({tag:"label",classes:["labelField"],textContent:e}),this.addChild([this.label,this.input])}setValidMessage(e,t){const s=this.input.getElement(),a=s.getAttribute("minlength");s.validity.tooShort?s.setCustomValidity(`Minimum length for the field must be ${a} symbols `):s.setCustomValidity(""),e&&t&&(e.test(s.value)||s.setCustomValidity(`${t}`)),s.reportValidity()}clear(){this.input.getElement().value=""}getInputValue(){const e=this.input.element.getAttribute("name"),{value:t}=this.input.element;return(0,i.isNotNull)(e),{[e]:t}}}t.default=o},162:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(181));s(738);class n extends i.default{constructor(e,t){super({tag:"form",classes:["formContainer","invalid"],attributes:[{key:"autocomplete",value:"off"}]}),this.inputs=e,this.buttons=t,this.setIputsCallback(),this.addChild([...this.inputs,...this.buttons])}setIputsCallback(){this.inputs.forEach((e=>e.element.addEventListener("input",(()=>this.checkValid()))))}checkValid(){const e=this.element;e.checkValidity()?e.classList.remove("invalid"):e.classList.add("invalid")}removeInputValues(){this.inputs.forEach((e=>e.clear()))}getInputValues(){return this.inputs.map((e=>e.getInputValue()))}}t.default=n},990:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(181));s(315);class n extends i.default{constructor(e){super({tag:"div",classes:["overlay"]}),this.content=e,this.buildModal(this.content)}buildModal(e){const t=new i.default({tag:"div",classes:["modal"]}),s=new i.default({tag:"span",classes:["modalText"],textContent:`${e}`});t.addChild([s]),this.addChild([t])}openModal(){document.body.append(this.getElement())}closeModal(){this.getElement().remove()}}t.default=n},679:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(181));class n extends i.default{constructor(){super({tag:"a",classes:["infoLink"],textContent:"Author Svetlana Ilina",attributes:[{key:"href",value:"https://github.com/SvetaIlina"}]})}}t.default=n},626:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(475)),n=s(187),o=s(505),l=a(s(607));t.default=class{constructor(e,t,s){this.model=t,this.view=s,this.view.subscribe(this),this.ws=new l.default(e,this.handleWebSocketOnopen.bind(this),this.handleWebSocketMessage.bind(this),this.handleWebSocketOnClose.bind(this)),this.router=new i.default(this,this.model)}init(){this.view.showModal(o.ConnectMessage.InProcess),this.ws.initWebSocket(),document.body.append(this.view.getElement())}handleWebSocketOnopen(e,t){this.goToPage(),this.view.showModal(t,e)}handleWebSocketOnClose(e,t){this.view.showModal(t,e)}handleWebSocketMessage(e){const t=JSON.parse(e.data),{type:s}=t;switch(s){case o.messageType.Login:this.model.setMyUser(),this.router.route(o.PageIds.MainPage);break;case o.messageType.Logout:this.model.deleteUser(),this.router.route(o.PageIds.LoginPage);break;case o.messageType.ActiveUser:{this.getUsers.call(this,o.messageType.InactiveUser);const e=(0,n.checkServerData)(t,"users");if(Array.isArray(e)){const t=e;this.model.ActiveUser=t}break}case o.messageType.InactiveUser:{const e=(0,n.checkServerData)(t,"users");if(Array.isArray(e)){const t=e;this.model.inActiveUser=t,(0,n.isNotNull)(this.model.myUser),this.authorizeUser(this.model.myUser)}break}case o.messageType.AnotherUserLogin:case o.messageType.AnotherUserLogout:{const e=(0,n.checkServerData)(t,"user");this.model.changeUserStatus(e),this.view.updateUserStatus(e);break}case o.messageType.SendMSG:{const e=(0,n.checkServerData)(t,"message"),s=this.model.checkMessage(e);if(this.model.currentContact){const t=this.model.currentContact.login;(0,n.isNotNull)(this.model.myUser),t===e.from||e.from===this.model.myUser.login?this.view.addMessage(s):this.view.setUnreadMessage(e.from)}else this.view.setUnreadMessage(e.from);break}case o.messageType.MsgHistory:{const e=(0,n.checkServerData)(t,"messages");Array.isArray(e)&&e.forEach((e=>{const t=this.model.checkMessage(e);this.view.addMessage(t)}));break}case o.messageType.Error:{const e=(0,n.checkServerData)(t,"error");"string"==typeof e&&this.view.showModal(e,this.ws.isOpen);break}default:console.log("nothing")}}update(e,t){switch(e){case"login":{(0,n.isNotNull)(t);const e=JSON.parse(t);this.model.myUser=e,this.getUsers.call(this,o.messageType.ActiveUser);break}case"showInfo":this.router.route(o.PageIds.InfoPage);break;case"logOut":this.userLogout();break;case"contactSelected":{(0,n.isNotNull)(t),this.model.setCurrentContact(t),(0,n.isNotNull)(this.model.currentContact);const e={id:crypto.randomUUID(),type:"MSG_FROM_USER",payload:{user:{login:t}}};this.ws.sendRequest(e),this.view.setUserContact(this.model.currentContact);break}case"sendMessage":if((0,n.isNotNull)(t),this.model.currentContact){const e={id:crypto.randomUUID(),type:"MSG_SEND",payload:{message:{to:this.model.currentContact.login,text:t}}};this.ws.sendRequest(e)}break;default:console.log("nothing")}}displayContent(e){if(this.model.myUser){const t=this.model.myUser.login,s=this.model.getAllContact();this.view.createPage(e,t,s)}else this.view.createPage(e)}authorizeUser(e){if(this.model.checkLogginedUser()){const e="User is already authorize";this.model.myUser=null,this.view.showModal(e,this.ws.isOpen)}else{const t={id:crypto.randomUUID(),type:o.messageType.Login,payload:{user:{login:e.login,password:e.password}}};this.ws.sendRequest(t)}}getUsers(e){const t={id:crypto.randomUUID(),type:e,payload:null};this.ws.sendRequest(t)}userLogout(){const e=this.model.myUser;(0,n.isNotNull)(e);const t={id:crypto.randomUUID(),type:o.messageType.Logout,payload:{user:{login:e.login,password:e.password}}};this.ws.sendRequest(t)}goToPage(){this.model.checkSavedUser()?this.getUsers.call(this,o.messageType.ActiveUser):this.router.route(o.PageIds.LoginPage)}}},156:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(803));s(284);const n=a(s(626)),o=new(a(s(720)).default),l=new i.default;new n.default("ws://localhost:4000",o,l).init()},769:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(181));s(581);class n extends i.default{constructor(){super({tag:"div",classes:["page"]}),this.observers=[]}subscribe(e){this.observers.push(e)}notifyObservers(e,t){this.observers.forEach((s=>{s.update(e,t)}))}getPageElement(){return this.getElement()}}t.default=n},300:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(181)),n=a(s(203)),o=a(s(769));s(343);const l=a(s(679));class r extends o.default{constructor(){super(),this.configView()}configView(){const e=new i.default({tag:"div",classes:["infoWrapper"]}),t=new i.default({tag:"h1",classes:["infoTitle"],textContent:"Fun Chat"}),s=new i.default({tag:"p",classes:["infoText"],textContent:"Welcome to the chat room! This chat room has been created as part of the RSSchool JS/FE 2023Q3 course. Here you can chat with other users, send messages, and share your thoughts. Please remember that this is a learning project and we value your participation and feedback. Enjoy your conversations!"}),a=new n.default(["backBtn"],"Back",(()=>{this.notifyObservers("back")}));e.addChild([t,s,new l.default,a]),this.addChild([e])}}t.default=r},424:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(162)),n=a(s(203)),o=a(s(292)),l=a(s(769));class r extends l.default{constructor(){super(),this.form=this.createForm(),this.addChild([this.form])}createForm(){const e=new n.default(["form_btn","login-btn"],"Login",(e=>{e.preventDefault(),this.notifyObservers("login",this.getUser())}),"submit"),t=new n.default(["form_btn"],"About",(e=>{e.preventDefault(),this.notifyObservers("showInfo")})),s=new o.default("User name",3,"login","text"),a=new o.default("Password",6,"password","password",/^(?=.*[0-9])(?=.*[A-Z]).+$/,"Password must contain at least one capital letter and a digit");return new i.default([s,a],[e,t])}clear(){this.form.removeInputValues()}getUser(){const e=this.form.getInputValues().reduce(((e,t)=>({...e,...t})),{});return JSON.stringify(e)}}t.default=r},587:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(880)),n=a(s(42)),o=a(s(514)),l=a(s(769));class r extends l.default{constructor(e,t){super(),this.header=new o.default(`${e}`,"fun Chat",(()=>this.notifyObservers("logOut")),(()=>this.notifyObservers("showInfo"))),this.footer=new n.default,this.chat=new i.default(t,(e=>this.notifyObservers("contactSelected",e))),this.addChild([this.header,this.chat,this.footer])}updateContactList(e){this.chat.updateContact(e)}updateChat(e){this.chat.setHeader(e),this.chat.updateDialog()}addNewMessage(e){this.chat.drawNewMessage(e)}}t.default=r},916:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(181)),n=a(s(769));class o extends n.default{constructor(){super(),this.configView()}configView(){const e=new i.default({tag:"div",classes:["infoWrapper"]}),t=new i.default({tag:"h1",classes:["infoTitle"],textContent:"Page not Found"});e.addChild([t]),this.addChild([e])}}t.default=o},475:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const a=s(505);t.default=class{constructor(e,t){this.manager=e,this.chatData=t,window.addEventListener("hashchange",(()=>{this.locationHandler()})),this.currentPage=""}route(e){window.location.hash=e,this.locationHandler()}locationHandler(){const e=window.location.hash.slice(1),t=this.chatData.isLogined;if(!t&&e===a.PageIds.MainPage)return window.location.hash=a.PageIds.LoginPage,void alert("need log in");this.currentPage===a.PageIds.MainPage&&e===a.PageIds.LoginPage&&t&&(window.location.hash=a.PageIds.MainPage),this.manager.displayContent(e),this.currentPage=e}}},187:(e,t)=>{function s(e){if(null==e)throw new Error(`Not expected value: ${e}`)}function a(e){if(null==e||!(e instanceof HTMLElement))throw new Error(`Not expected value: ${e}`)}Object.defineProperty(t,"__esModule",{value:!0}),t.findUserIndex=t.getSelectedContact=t.checkServerData=t.searchUser=t.isNotNullElement=t.isNotNull=void 0,t.isNotNull=s,t.isNotNullElement=a,t.searchUser=function(e,t){const i=e.target;a(i);const{value:n}=i;Array.from(t.children).forEach((e=>{if(e instanceof HTMLElement){const t=e.textContent,a=e;s(t),t.match(n)?a.style.display="block":a.style.display="none"}}))},t.checkServerData=function(e,t){s(e.payload);const{payload:a}=e;return"users"in a&&"users"===t?a.users:"user"in a&&"user"===t?a.user:"messages"in a&&"messages"===t?a.messages:"message"in a&&"message"===t?a.message:"error"in a&&"error"===t?a.error:null},t.getSelectedContact=function(e){let t=null;const{target:s}=e;return a(s),s.classList.contains("list_item-name")&&(t=s.textContent),t},t.findUserIndex=function(e,t){const s=t.login;return e.findIndex((e=>e.login===s))}},505:(e,t)=>{var s,a,i,n;Object.defineProperty(t,"__esModule",{value:!0}),t.messageType=t.userStatus=t.ConnectMessage=t.PageIds=void 0,function(e){e.LoginPage="login-page",e.MainPage="main-page",e.InfoPage="info-page"}(s||(t.PageIds=s={})),function(e){e.InProcess="Connecting...",e.Ready="Connect"}(a||(t.ConnectMessage=a={})),function(e){e.OnLine="On Line",e.OffLine="Off Line"}(i||(t.userStatus=i={})),function(e){e.Login="USER_LOGIN",e.Error="ERROR",e.Logout="USER_LOGOUT",e.AnotherUserLogin="USER_EXTERNAL_LOGIN",e.AnotherUserLogout="USER_EXTERNAL_LOGOUT",e.ActiveUser="USER_ACTIVE",e.InactiveUser="USER_INACTIVE",e.SendMSG="MSG_SEND",e.MsgHistory="MSG_FROM_USER",e.MsgDelivered="MSG_DELIVER",e.MsgRead="MSG_READ",e.MsgDelete="MSG_DELETE",e.MsgEdit="MSG_EDIT"}(n||(t.messageType=n={}))},803:function(e,t,s){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(s(424)),n=a(s(300)),o=s(505),l=a(s(916)),r=a(s(587)),d=a(s(990)),u=s(187),c=a(s(769)),h=a(s(555));class g extends c.default{constructor(){super(),this.element=document.createElement("main"),this.setStyles(["main"]),this.mainPage=null,this.modalIsOpen=!1,this.element.addEventListener("sendMes",(e=>{this.notifyObservers("sendMessage",e.detail)}))}update(e,t){switch(e){case"login":(0,u.isNotNull)(t),this.notifyObservers(e,t);break;case"showInfo":case"logOut":this.notifyObservers(e);break;case"back":window.history.back();break;case"contactSelected":this.notifyObservers(e,t);break;default:console.log("nothing")}}setContent(e){this.removeChild(),e&&this.addChild([e])}createPage(e,t,s){let a=null,d=null;e===o.PageIds.LoginPage?d=new i.default:e===o.PageIds.MainPage?((0,u.isNotNull)(t),(0,u.isNotNull)(s),this.mainPage=new r.default(t,s),d=this.mainPage):d=e===o.PageIds.InfoPage?new n.default:new l.default,d.subscribe(this),a=d.getElement(),this.setContent(a)}showModal(e,t){if(this.modalIsOpen)this.replaceModal(e,t);else{const s=new d.default(`${e}`);s.openModal(),this.modalIsOpen=!0,this.closeThisModal(t,s)}}replaceModal(e,t){const s=document.querySelector(".overlay");(0,u.isNotNull)(s);const a=new d.default(`${e}`);s.replaceWith(a.getElement()),this.closeThisModal(t,a)}closeThisModal(e,t){e&&(this.modalIsOpen=!1,setTimeout((()=>t.closeModal()),1e3))}updateUserStatus(e){(0,u.isNotNull)(this.mainPage),this.mainPage.updateContactList(e)}setUserContact(e){(0,u.isNotNull)(this.mainPage),this.mainPage.updateChat(e)}addMessage(e){(0,u.isNotNull)(this.mainPage);const t=new h.default(e);this.mainPage.addNewMessage(t)}setUnreadMessage(e){(0,u.isNotNull)(this.mainPage);const t=document.getElementById(`${e}`);(0,u.isNotNull)(t);const s=t.querySelector(".list_item-mes");(0,u.isNotNull)(s);let a=Number(s.textContent);(0,u.isNotNull)(a),s.textContent=`${a+=1}`}}t.default=g},607:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const a=s(187),i=s(505);t.default=class{constructor(e,t,s,a){this.url=e,this.ws=null,this.isOpen=!1,this.onOpenCb=t,this.onCloseCb=a,this.onMessageCb=s,this.initWebSocket()}sendRequest(e){(0,a.isNotNull)(this.ws),this.ws.send(JSON.stringify(e))}initWebSocket(){this.ws=new WebSocket(this.url),this.ws.addEventListener("open",(()=>this.onOpen(this.onOpenCb))),this.ws.addEventListener("message",(e=>{this.onMessageCb(e)})),this.ws.addEventListener("close",(()=>{this.onClose(this.onCloseCb)}))}onClose(e){this.isOpen=!1,(0,a.isNotNull)(this.ws),this.ws.removeEventListener("open",(()=>this.onOpen(this.onOpenCb))),this.ws.removeEventListener("close",(()=>this.onClose(this.onCloseCb))),this.ws.removeEventListener("message",(e=>this.onMessageCb(e))),e(this.isOpen,i.ConnectMessage.InProcess),this.initWebSocket()}onOpen(e){this.isOpen=!0,1===this.ws?.readyState&&e(this.isOpen,i.ConnectMessage.Ready)}}},72:(e,t,s)=>{e.exports=s.p+"ad178c0df28bc133be34.svg"}},t={};function s(a){var i=t[a];if(void 0!==i)return i.exports;var n=t[a]={exports:{}};return e[a].call(n.exports,n,n.exports,s),n.exports}s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");if(a.length)for(var i=a.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=a[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),s(156)})();
//# sourceMappingURL=bundle.js.map